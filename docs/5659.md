# 2018 å¹´ JavaScript çš„æˆæœ¬ã€‚æ›´æ–°:2019 å¹´ JavaScript çš„æˆæœ¬â€¦ |ä½œè€… Addy Osmani | Medium

> åŸæ–‡ï¼š<https://medium.com/@addyosmani/the-cost-of-javascript-in-2018-7d8950fbb5d4?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website>



# **2018 å¹´ JavaScript çš„æˆæœ¬**

***æ›´æ–°:***[***2019 å¹´ JavaScript æˆæœ¬***](https://v8.dev/blog/cost-of-javascript-2019) ***ç°å·²å¯ä¾›é˜…è¯»ã€‚*T13ã€‘**

æ„å»º [**äº¤äº’å¼**](https://philipwalton.com/articles/why-web-developers-need-to-care-about-interactivity/) **ç½‘ç«™**å¯èƒ½éœ€è¦å‘ç”¨æˆ·å‘é€ JavaScriptã€‚é€šå¸¸ï¼Œ**å¤ªå¤š**äº†ã€‚ä½ æ˜¯å¦æ›¾ç»åœ¨ä¸€ä¸ªæ‰‹æœºé¡µé¢ä¸Šç‚¹å‡»ä¸€ä¸ªé“¾æ¥ï¼Œæˆ–è€…å°è¯•æ»šåŠ¨ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•ååº”ï¼Ÿ

ç¡®åˆ‡åœ°è¯´ï¼ŒJavaScript ä»ç„¶æ˜¯æˆ‘ä»¬å‘é€åˆ°æ‰‹æœºä¸Šçš„æœ€æ˜‚è´µçš„èµ„æºï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå»¶è¿Ÿäº¤äº’æ€§ã€‚



JavaScript processing times for CNN.com as measured by [WebPageTest](https://webpagetest.org) ([src](http://bit.ly/jscost-wpt)). A high-end phone (iPhone 8) processes script in ~4s. Compare to the ~13s an [average phone](https://infrequently.org/2017/10/can-you-afford-it-real-world-web-performance-budgets/) (Moto G4) takes or the ~36s taken by a low-end 2018 phone (Alcatel 1X).



ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›ç­–ç•¥ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›ç­–ç•¥é«˜æ•ˆåœ°äº¤ä»˜ JavaScriptï¼ŒåŒæ—¶ä»ç„¶ç»™ç”¨æˆ·æä¾›æœ‰ä»·å€¼çš„ä½“éªŒã€‚

# **TLï¼›åšå£«:**

*   **ä¸ºäº†ä¿æŒé€Ÿåº¦**ï¼Œ**åªåŠ è½½å½“å‰é¡µé¢æ‰€éœ€çš„ JavaScriptã€‚**å¯¹ç”¨æˆ·*éœ€è¦çš„*è¿›è¡Œä¼˜å…ˆæ’åºï¼Œç”¨[ä»£ç åˆ†å‰²](https://webpack.js.org/guides/code-splitting/)å»¶è¿ŸåŠ è½½å…¶ä½™çš„ã€‚è¿™ç»™äº†ä½ æœ€å¥½çš„æœºä¼šå¿«é€ŸåŠ è½½å’Œäº¤äº’ã€‚é»˜è®¤æƒ…å†µä¸‹*ä½¿ç”¨åŸºäºè·¯å¾„çš„ä»£ç åˆ†å‰²çš„å †æ ˆ*æ˜¯æ¸¸æˆè§„åˆ™æ”¹å˜è€…ã€‚
*   æ¥å—ç»©æ•ˆé¢„ç®—ï¼Œå¹¶å­¦ä¼šåœ¨é¢„ç®—å†…ç”Ÿæ´»ã€‚å¯¹äºç§»åŠ¨ï¼Œç›®æ ‡æ˜¯ [JS é¢„ç®—< 170KB ç¼©å°/å‹ç¼©](https://infrequently.org/2017/10/can-you-afford-it-real-world-web-performance-budgets/)ã€‚æœªç»å‹ç¼©ï¼Œè¿™ä»ç„¶æ˜¯å¤§çº¦ 0.7MB çš„ä»£ç ã€‚é¢„ç®—æ˜¯æˆåŠŸçš„å…³é”®ï¼Œä½†æ˜¯ï¼Œä»–ä»¬ä¸èƒ½å­¤ç«‹åœ°ç¥å¥‡åœ°ä¿®å¤æ€§èƒ½ã€‚[å›¢é˜Ÿæ–‡åŒ–ã€ç»“æ„å’Œæ‰§è¡Œäº‹å®œ](https://twitter.com/tkadlec/status/1018529148862652417?s=19)ã€‚æ²¡æœ‰é¢„ç®—çš„å»ºç­‘ä¼šå¯¼è‡´æ€§èƒ½é€€åŒ–å’Œå¤±è´¥ã€‚
*   **å­¦ä¹ å¦‚ä½•** [**å®¡è®¡**](https://nolanlawson.com/2018/03/20/smaller-lodash-bundles-with-webpack-and-babel/) **å¹¶æ•´ç†æ‚¨çš„ JavaScript åŒ…ã€‚**å½“ä½ åªéœ€è¦ä¸€å°éƒ¨åˆ†ï¼Œä¸éœ€è¦çš„æµè§ˆå™¨çš„å¤šå¡«å……ï¼Œæˆ–è€…é‡å¤ä»£ç çš„æ—¶å€™ï¼Œä½ å¾ˆæœ‰å¯èƒ½[å‘å¸ƒå®Œæ•´çš„åº“ã€‚](https://github.com/GoogleChromeLabs/webpack-libs-optimizations)
*   æ¯ä¸€æ¬¡äº’åŠ¨éƒ½æ˜¯æ–°çš„â€œäº’åŠ¨æ—¶é—´â€çš„å¼€å§‹ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹è€ƒè™‘ä¼˜åŒ–ã€‚ä¼ è¾“å¤§å°å¯¹äºä½ç«¯ç§»åŠ¨ç½‘ç»œè‡³å…³é‡è¦ï¼ŒJavaScript è§£ææ—¶é—´å¯¹äº CPU å—é™çš„è®¾å¤‡è‡³å…³é‡è¦ã€‚
*   å¦‚æœå®¢æˆ·ç«¯ JavaScript å¯¹ç”¨æˆ·ä½“éªŒæ²¡æœ‰å¥½å¤„ï¼Œé—®é—®è‡ªå·±æ˜¯å¦çœŸçš„æœ‰å¿…è¦ã€‚ä¹Ÿè®¸æœåŠ¡å™¨ç«¯å‘ˆç°çš„ HTML å®é™…ä¸Šä¼šæ›´å¿«ã€‚è€ƒè™‘å°†å®¢æˆ·ç«¯æ¡†æ¶çš„ä½¿ç”¨é™åˆ¶åœ¨ç»å¯¹éœ€è¦å®ƒä»¬çš„é¡µé¢ä¸Šã€‚æœåŠ¡å™¨æ¸²æŸ“*å’Œ*å®¢æˆ·ç«¯æ¸²æŸ“å¦‚æœåšå¾—ä¸å¥½å°±æ˜¯ä¸€åœºç¾éš¾ã€‚



Video for my recent talk on â€œThe Cost of JavaScriptâ€ on which this write-up is based.



# ç”¨æˆ·çš„â€œä½“éªŒâ€è®©ç½‘ç»œå˜å¾—è‡ƒè‚¿

å½“ç”¨æˆ·è®¿é—®ä½ çš„ç½‘ç«™æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘é€å¾ˆå¤šæ–‡ä»¶ï¼Œå…¶ä¸­å¾ˆå¤šæ˜¯è„šæœ¬ã€‚ä» web æµè§ˆå™¨çš„è§’åº¦æ¥çœ‹ï¼Œè¿™çœ‹èµ·æ¥æœ‰ç‚¹åƒè¿™æ ·:



A mad rush of files being thrown at you.



å°½ç®¡æˆ‘å¾ˆå–œæ¬¢ JavaScriptï¼Œä½†å®ƒæ€»æ˜¯ç½‘ç«™ä¸­æœ€æ˜‚è´µçš„éƒ¨åˆ†ã€‚æˆ‘æƒ³è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ã€‚



ä»Šå¤©çš„ä¸­å€¼ç½‘é¡µç›®å‰å‘å¸ƒäº†å¤§çº¦ 350 KB çš„ç¼©å°å’Œå‹ç¼©çš„ JavaScript ä»£ç ã€‚å¦‚æœä¸å‹ç¼©ï¼Œæµè§ˆå™¨éœ€è¦å¤„ç†çš„è„šæœ¬ä¼šè†¨èƒ€åˆ° 1MB ä»¥ä¸Šã€‚

æ³¨æ„:ä¸ç¡®å®šä½ çš„ JavaScript åŒ…æ˜¯å¦å»¶ç¼“äº†ç”¨æˆ·ä¸ä½ çš„ç½‘ç«™äº’åŠ¨çš„é€Ÿåº¦ï¼Ÿé€€æˆ¿ [**ç¯å¡”**](https://developers.google.com/web/tools/lighthouse/) **ã€‚**



Statistics from the [HTTP Archive state of JavaScript report, July 2018](https://httparchive.org/reports/state-of-javascript) highlight the median webpage ships ~350KB of minified and compressed script. These pages take up to 15s to get interactive.



**ä¸‹è½½è¿™ä¹ˆå¤š JavaScript éœ€è¦èŠ±è´¹è¶…è¿‡** [**14 ç§’çš„æ—¶é—´æ¥åŠ è½½ï¼Œå¹¶åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè·å¾—äº’åŠ¨**](https://beta.httparchive.org/reports/loading-speed#ttci) **ã€‚**

å…¶ä¸­å¾ˆå¤§ä¸€ä¸ªå› ç´ æ˜¯åœ¨ç§»åŠ¨ç½‘ç»œä¸Šä¸‹è½½ä»£ç ï¼Œç„¶ååœ¨ç§»åŠ¨ CPU ä¸Šå¤„ç†å®ƒéœ€è¦å¤šé•¿æ—¶é—´ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ç§»åŠ¨ç½‘ç»œã€‚



Countries that perform better in a particular metric are shaded darker. Countries not included are in grey. Itâ€™s also worth [noting](https://www.telecompetitor.com/report-u-s-rural-mobile-broadband-speeds-are-20-9-slower-than-urban/) that rural broadband speeds, even in the US, can be 20% slower than urban areas.



OpenSignal çš„è¿™å¼ [å›¾æ˜¾ç¤ºäº†å…¨çƒ 4G ç½‘ç»œçš„ä¸€è‡´æ€§ï¼Œä»¥åŠæ¯ä¸ªå›½å®¶ç”¨æˆ·çš„å¹³å‡è¿æ¥é€Ÿåº¦ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œè®¸å¤šå›½å®¶çš„è¿æ¥é€Ÿåº¦ä»ç„¶æ¯”æˆ‘ä»¬æƒ³è±¡çš„è¦æ…¢ã€‚](https://opensignal.com/reports/2018/02/global-state-of-the-mobile-network)

æ—©æœŸä¸­ç­‰ç½‘ç«™çš„ 350 KB çš„è„šæœ¬ä¸ä»…éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ä¸‹è½½ï¼Œäº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬çœ‹çœ‹æµè¡Œçš„ç½‘ç«™ï¼Œå®ƒä»¬å®é™…ä¸Šä¸‹è½½äº†æ¯”è¿™å¤šå¾—å¤šçš„è„šæœ¬:



Uncompressed JS bundle size numbers from â€œ[Bringing Facebook.com and the web up to speed](https://www.youtube.com/watch?v=XhOIE3l8GEY)â€. Sites like Google Sheets are highlighted as shipping up to 5.8MB of script (when decompressed).



æˆ‘ä»¬åœ¨æ¡Œé¢å’Œç§»åŠ¨ç½‘ç»œä¸Šéƒ½é‡åˆ°äº†è¿™ä¸ªå¤©èŠ±æ¿ï¼Œåœ¨è¿™äº›åœ°æ–¹ï¼Œç½‘ç«™æœ‰æ—¶ä¼šå‘é€ä»·å€¼æ•°å…†å­—èŠ‚çš„ä»£ç ï¼Œç„¶åæµè§ˆå™¨éœ€è¦å¤„ç†è¿™äº›ä»£ç ã€‚è¦é—®çš„é—®é¢˜æ˜¯ï¼Œ [**ä½ ä¹°å¾—èµ·è¿™ä¹ˆå¤š JavaScript**](https://infrequently.org/2017/10/can-you-afford-it-real-world-web-performance-budgets/) **ï¼Ÿ**

# JavaScript æ˜¯æœ‰æˆæœ¬çš„



â€œSites with this much script are simply inaccessible to a broad swath of the worldâ€™s users; statistically, users do not (and will not) wait for these experiences to loadâ€ â€” Alex Russell



**æ³¨æ„:å¦‚æœä½ å‘é€äº†å¤ªå¤šçš„è„šæœ¬ï¼Œè€ƒè™‘ä½¿ç”¨** [**ä»£ç åˆ†å‰²**](https://webpack.js.org/guides/code-splitting/) **æ¥åˆ†è§£åŒ…æˆ–è€…** [**ä½¿ç”¨æ ‘æ‘‡åŠ¨**](https://developers.google.com/web/fundamentals/performance/optimizing-javascript/tree-shaking/) **æ¥å‡å°‘ JS è´Ÿè½½ã€‚**

å¦‚ä»Šï¼Œç½‘ç«™é€šå¸¸ä¼šåœ¨å…¶ JS åŒ…ä¸­å‘é€ä»¥ä¸‹å†…å®¹:

*   å®¢æˆ·ç«¯æ¡†æ¶æˆ– UI åº“
*   çŠ¶æ€ç®¡ç†è§£å†³æ–¹æ¡ˆ(ä¾‹å¦‚ Redux)
*   å¤šå¡«å……(é€šå¸¸ç”¨äºä¸éœ€è¦å®ƒä»¬çš„ç°ä»£æµè§ˆå™¨)
*   å®Œæ•´åº“ä¸ä»…ä»–ä»¬ä½¿ç”¨çš„åº“(ä¾‹å¦‚ï¼Œæ‰€æœ‰ lodashã€Moment + locales)
*   ä¸€å¥—ç”¨æˆ·ç•Œé¢ç»„ä»¶(æŒ‰é’®ï¼Œæ ‡é¢˜ï¼Œä¾§è¾¹æ ç­‰)ã€‚)

è¿™æ®µä»£ç åŠ èµ·æ¥ã€‚è¶Šå¤šï¼Œé¡µé¢åŠ è½½çš„æ—¶é—´å°±è¶Šé•¿ã€‚

åŠ è½½ä¸€ä¸ªç½‘é¡µå°±åƒä¸€ä¸ªæœ‰ä¸‰ä¸ªå…³é”®æ—¶åˆ»çš„ç”µå½±èƒ¶ç‰‡ã€‚

æœ‰:è¿™æ˜¯çœŸçš„å—ï¼Ÿæœ‰ç”¨å—ï¼Ÿå¹¶ä¸”ï¼Œå®ƒæ˜¯å¦å¯ç”¨ï¼Ÿ



Loading is a journey. Weâ€™re shifting to increasing caring about user-centric happiness metrics. Rather than just looking at onload or domContentLoaded, we now ask â€œwhen can a user actually *use* the page?â€. If they tap on a piece of user-interface, does it respond right away?



***æ­£åœ¨å‘ç”Ÿ*** æ˜¯ä½ èƒ½å¤Ÿå‘å±å¹•ä¼ é€’ä¸€äº›å†…å®¹çš„æ—¶åˆ»ã€‚(*å¯¼èˆªå¼€å§‹äº†å—ï¼ŸæœåŠ¡å™¨å¼€å§‹å“åº”äº†å—ï¼Ÿ)*

***æœ‰ç”¨å—*** æ˜¯ä½ ç”»å‡ºæ–‡æœ¬æˆ–å†…å®¹ï¼Œè®©ç”¨æˆ·ä»ä½“éªŒä¸­è·å¾—ä»·å€¼å¹¶å‚ä¸å…¶ä¸­çš„æ—¶åˆ»ã€‚

ç„¶å*æ˜¯ç”¨æˆ·å¯ä»¥å¼€å§‹æœ‰æ„ä¹‰åœ°ä¸ä½“éªŒäº’åŠ¨å¹¶è®©äº‹æƒ…å‘ç”Ÿçš„æ—¶åˆ»ã€‚*

*æˆ‘ä¹‹å‰æåˆ°è¿‡â€œäº’åŠ¨â€è¿™ä¸ªè¯ï¼Œä½†æ˜¯é‚£æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ*



*A visualization of Time-to-Interactive highlighting how a poorly loaded experience makes the user think they can accomplish a goal, when in fact, the page hasnâ€™t finished loading all of the code necessary for this to be true. With thanks to Kevin Schaaf for the interactivity animation*



*å¯¹äºä¸€ä¸ªå…·æœ‰äº¤äº’æ€§çš„é¡µé¢æ¥è¯´ï¼Œå®ƒå¿…é¡»èƒ½å¤Ÿå¿«é€Ÿå“åº”ç”¨æˆ·çš„è¾“å…¥ã€‚ä¸€ä¸ªå°çš„ JavaScript æœ‰æ•ˆè´Ÿè½½å¯ä»¥ç¡®ä¿è¿™ç§æƒ…å†µå¿«é€Ÿå‘ç”Ÿã€‚*

*æ— è®ºç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥ï¼Œè¿˜æ˜¯æ»šåŠ¨ä¸€ä¸ªé¡µé¢ï¼Œä»–ä»¬éƒ½éœ€è¦çœ‹åˆ°å“åº”ä»–ä»¬çš„åŠ¨ä½œçš„å®é™…å‘ç”Ÿçš„äº‹æƒ…ã€‚ä¸èƒ½å®ç°è¿™ä¸€ç‚¹çš„ä½“éªŒä¼šè®©ä½ çš„ç”¨æˆ·æ„Ÿåˆ°æ²®ä¸§ã€‚*



*Lighthouse measures a range of user-centric performance metrics, like Time-to-Interactive, in a lab setting.*



*è¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿçš„ä¸€ä¸ªåœ°æ–¹æ˜¯ï¼Œå½“äººä»¬åœ¨æœåŠ¡å™¨ç«¯å‘ˆç°ä¸€ä¸ªä½“éªŒæ—¶ï¼Œ*å’Œ*ç„¶åä¸‹è½½ä¸€å † JavaScript æ¥â€œæ°´åˆâ€ç•Œé¢(é™„åŠ äº‹ä»¶å¤„ç†ç¨‹åºå’Œé¢å¤–çš„è¡Œä¸º)ã€‚*

*å½“æµè§ˆå™¨è¿è¡Œè®¸å¤šæ‚¨å¯èƒ½éœ€è¦çš„äº‹ä»¶æ—¶ï¼Œå®ƒå¯èƒ½ä¼šåœ¨å¤„ç†ç”¨æˆ·è¾“å…¥çš„åŒä¸€ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œã€‚è¿™ä¸ªçº¿ç¨‹ç§°ä¸ºä¸»çº¿ç¨‹ã€‚*

***å°†è¿‡å¤šçš„ JavaScript åŠ è½½åˆ°ä¸»çº¿ç¨‹ä¸­(é€šè¿‡<è„šæœ¬>ç­‰)æ˜¯é—®é¢˜æ‰€åœ¨ã€‚å°† JS æ”¾å…¥**[**Web Worker**](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers)**æˆ–é€šè¿‡** [**æœåŠ¡ Worker**](https://developers.google.com/web/fundamentals/primers/service-workers/) **è¿›è¡Œç¼“å­˜ä¸ä¼šå¯¹äº¤äº’æ—¶é—´äº§ç”ŸåŒæ ·çš„è´Ÿé¢å½±å“ã€‚***



*Hereâ€™s an example where a user may tap around some UI. Ordinarily, they might check a checkbox or click a link and everythingâ€™s going to work perfectly fine. But if we simulate blocking the main thread, nothingâ€™s able to happen. They are not able to check that checkbox or click links because the main thread is blocked.*



*å°½å¯èƒ½é¿å…é˜»å¡ä¸»çº¿ç¨‹ã€‚**æ›´å¤šå†…å®¹ï¼Œè¯·å‚è§â€œ** [**ä¸ºä»€ä¹ˆ web å¼€å‘è€…éœ€è¦å…³å¿ƒäº¤äº’æ€§**](https://philipwalton.com/articles/why-web-developers-need-to-care-about-interactivity/)**â€***

*æˆ‘ä»¬çœ‹åˆ°ä¸æˆ‘ä»¬åˆä½œçš„å›¢é˜Ÿé­å— JavaScript å½±å“è®¸å¤šç±»å‹ç½‘ç«™çš„äº¤äº’æ€§ã€‚*



*JavaScript can delay interactivity for visible elements. Visualized are a number of UI elements from Google Search.*



***è¿‡å¤š(ä¸»çº¿ç¨‹)JavaScript ä¼šå»¶è¿Ÿå¯è§å…ƒç´ çš„äº¤äº’æ€§ã€‚è¿™å¯¹è®¸å¤šå…¬å¸æ¥è¯´éƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ã€‚***

*ä¸Šé¢æ˜¯è°·æ­Œæœç´¢çš„å‡ ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥å¼€å§‹ç‚¹å‡»ç”¨æˆ·ç•Œé¢ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªç½‘ç«™ä¸‹è½½äº†å¤ªå¤šçš„ JavaScript ä»£ç ï¼Œåœ¨äº‹æƒ…çœŸæ­£å‘ç”Ÿä¹‹å‰å¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€‚è¿™ä¼šè®©ç”¨æˆ·æ„Ÿåˆ°æœ‰ç‚¹æ²®ä¸§ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„ä½“éªŒå°½å¯èƒ½å¿«åœ°äº’åŠ¨èµ·æ¥ã€‚*



*Time-to-Interactive of news.google.com as measured by WebPageTest and Lighthouse ([source](https://docs.google.com/spreadsheets/d/1x0LQV5oQsX3MdYe1lcy_gw3FzdJ0kNPUP2-cAl4N2g4/edit?usp=sharing))*



*æµ‹é‡è°·æ­Œæ–°é—»åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„äº’åŠ¨æ—¶é—´ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°é«˜ç«¯è®¾å¤‡åœ¨å¤§çº¦ 7 ç§’å†…äº’åŠ¨ä¸ä½ç«¯è®¾å¤‡åœ¨ 55 ç§’å†…äº’åŠ¨ä¹‹é—´çš„å·¨å¤§å·®å¼‚ã€‚é‚£ä¹ˆï¼Œ**ä»€ä¹ˆæ˜¯å¥½çš„äº’åŠ¨ç›®æ ‡å‘¢ï¼Ÿ***



*å½“è°ˆåˆ°äº’åŠ¨çš„æ—¶é—´æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºä½ çš„åŸºçº¿åº”è¯¥åœ¨ä¸­ç­‰ç§»åŠ¨è®¾å¤‡çš„æ…¢é€Ÿ 3G è¿æ¥ä¸Šåœ¨äº”ç§’é’Ÿå†…å¼€å§‹äº’åŠ¨ã€‚**â€œä½†æ˜¯ï¼Œæˆ‘çš„ç”¨æˆ·éƒ½åœ¨é«˜é€Ÿç½‘ç»œå’Œé«˜ç«¯æ‰‹æœºä¸Šï¼â€**â€¦æ˜¯å—ï¼Ÿä½ å¯èƒ½ä½¿ç”¨â€œå¿«é€Ÿâ€çš„å’–å•¡åº— WiFiï¼Œä½†å®é™…ä¸Šåªèƒ½è¾¾åˆ° 2G æˆ– 3G çš„é€Ÿåº¦ã€‚å¯å˜æ€§å¾ˆé‡è¦ã€‚*

*è°å‘å¸ƒäº†æ›´å°‘çš„ JavaScript å¹¶å‡å°‘äº†ä»–ä»¬çš„äº¤äº’æ—¶é—´ï¼Ÿ*



*è®©æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªæ›´æœ‰å¼¹æ€§çš„ç§»åŠ¨ç½‘ç»œï¼Œä¸è¦å¤ªä¾èµ–å¤§å‹ JavaScript è´Ÿè½½ã€‚*

*äº¤äº’æ€§å½±å“å¾ˆå¤šäº‹æƒ…ã€‚å®ƒå¯èƒ½ä¼šå—åˆ°åœ¨ç§»åŠ¨æ•°æ®è®¡åˆ’æˆ–å’–å•¡åº— WiFi ä¸ŠåŠ è½½æ‚¨çš„ç½‘ç«™çš„äººçš„å½±å“ï¼Œæˆ–è€…åªæ˜¯ä»–ä»¬åœ¨ç§»åŠ¨ä¸­æ–­æ–­ç»­ç»­çš„è¿æ¥ã€‚*



*å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œå¦‚æœæ‚¨æœ‰å¤§é‡çš„ JavaScript éœ€è¦å¤„ç†ï¼Œç”¨æˆ·å¯èƒ½æœ€ç»ˆä¼šç­‰å¾…ç«™ç‚¹å®é™…å‘ˆç°ä»»ä½•å†…å®¹ã€‚æˆ–è€…ï¼Œå¦‚æœæŸäº›ä¸œè¥¿*è¢«*æ¸²æŸ“ï¼Œä»–ä»¬å¯èƒ½è¦ç­‰å¾ˆé•¿æ—¶é—´æ‰èƒ½ä¸é¡µé¢ä¸Šçš„ä»»ä½•ä¸œè¥¿äº¤äº’ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå‡å°‘ JavaScript çš„å‘å¸ƒä¼šç¼“è§£è¿™äº›é—®é¢˜ã€‚*

# ***JavaScript ä¸ºä»€ä¹ˆè¿™ä¹ˆè´µï¼Ÿ***

*ä¸ºäº†è§£é‡Š JavaScript ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤§çš„å¼€é”€ï¼Œæˆ‘æƒ³å¸¦æ‚¨çœ‹ä¸€ä¸‹å½“æ‚¨å‘æµè§ˆå™¨å‘é€å†…å®¹æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ç”¨æˆ·åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­é”®å…¥ URL:*



*è¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ï¼Œç„¶åæœåŠ¡å™¨è¿”å›ä¸€äº›æ ‡è®°ã€‚ç„¶åï¼Œæµè§ˆå™¨è§£æè¯¥æ ‡è®°å¹¶å‘ç°å¿…è¦çš„ CSSã€JavaScript å’Œå›¾åƒã€‚ç„¶åï¼Œæµè§ˆå™¨å¿…é¡»è·å–å¹¶å¤„ç†æ‰€æœ‰è¿™äº›èµ„æºã€‚*

*ä¸Šé¢çš„åœºæ™¯æ˜¯å¯¹ Chrome å¤„ç†ä½ å‘é€çš„æ‰€æœ‰å†…å®¹æ—¶æ‰€å‘ç”Ÿçš„äº‹æƒ…çš„å‡†ç¡®æè¿°(æ˜¯çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¡¨æƒ…å·¥å‚)ã€‚*

*è¿™é‡Œçš„æŒ‘æˆ˜ä¹‹ä¸€æ˜¯ JavaScript æœ€ç»ˆæˆä¸ºç“¶é¢ˆã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå¿«é€Ÿç»˜åˆ¶åƒç´ ï¼Œç„¶åè®©é¡µé¢å…·æœ‰äº¤äº’æ€§ã€‚ä½†æ˜¯å¦‚æœ JavaScript æ˜¯ä¸€ä¸ªç“¶é¢ˆï¼Œä½ å¯èƒ½æœ€ç»ˆåªèƒ½çœ‹åˆ°ä¸€äº›ä½ å®é™…ä¸Šä¸èƒ½ä¸ä¹‹äº¤äº’çš„ä¸œè¥¿ã€‚*

*æˆ‘ä»¬å¸Œæœ›é˜²æ­¢ JavaScript æˆä¸ºç°ä»£ä½“éªŒçš„ç“¶é¢ˆã€‚*

*ä½œä¸ºä¸€ä¸ªè¡Œä¸šï¼Œè¦è®°ä½çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¿«é€ŸæŒæ¡ JavaScriptï¼Œæˆ‘ä»¬å¿…é¡»å¿«é€Ÿä¸‹è½½ã€è§£æã€ç¼–è¯‘ã€*å’Œ*æ‰§è¡Œå®ƒã€‚*



*è¿™æ„å‘³ç€æˆ‘ä»¬å¿…é¡»åœ¨ç½‘ç»œä¼ è¾“*å’Œ*æˆ‘ä»¬çš„è„šæœ¬çš„å¤„ç†æ–¹é¢å¿«é€Ÿã€‚*

*å¦‚æœä½ èŠ±å¾ˆé•¿æ—¶é—´åœ¨ JavaScript å¼•æ“ä¸­è§£æå’Œç¼–è¯‘è„šæœ¬ï¼Œè¿™ä¼šå»¶è¿Ÿç”¨æˆ·ä¸ä½ çš„ä½“éªŒäº’åŠ¨çš„é€Ÿåº¦ã€‚*

*ä¸ºäº†æä¾›è¿™æ–¹é¢çš„ä¸€äº›æ•°æ®ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…³äº [V8](https://developers.google.com/v8/) (Chrome çš„ JavaScript å¼•æ“)åœ¨å¤„ç†ä¸€ä¸ªåŒ…å«è„šæœ¬çš„é¡µé¢æ—¶èŠ±è´¹æ—¶é—´çš„ç»†åˆ†:*



*JavaScript parse/compile = 10â€“30% of the time spent in V8 (Chromeâ€™s JS engine) during page load*



*æ©™è‰²ä»£è¡¨è§£ææµè¡Œç½‘ç«™å‘é€çš„ JavaScript èŠ±è´¹çš„æ‰€æœ‰æ—¶é—´ã€‚é»„è‰²çš„æ˜¯ç¼–è¯‘èŠ±è´¹çš„æ—¶é—´ã€‚æ€»çš„æ¥è¯´ï¼Œè¿™äº›èŠ±è´¹äº†å¤„ç†é¡µé¢ JavaScript æ‰€éœ€æ—¶é—´çš„ 30%â€”â€”è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„æˆæœ¬ã€‚*

*ä» Chrome 66 å¼€å§‹ï¼ŒV8 [åœ¨åå°çº¿ç¨‹](https://v8project.blogspot.com/2018/03/v8-release-66.html)ä¸Šç¼–è¯‘ä»£ç ï¼Œç¼–è¯‘æ—¶é—´å‡å°‘äº† 20%ã€‚ä½†æ˜¯è§£æå’Œç¼–è¯‘ä»ç„¶éå¸¸æ˜‚è´µï¼Œå¾ˆå°‘çœ‹åˆ°ä¸€ä¸ªå¤§çš„è„šæœ¬åœ¨ 50 æ¯«ç§’å†…æ‰§è¡Œï¼Œå³ä½¿æ˜¯ç¦»çº¿ç¼–è¯‘ã€‚*

*JavaScript éœ€è¦è®°ä½çš„å¦ä¸€ä»¶äº‹æ˜¯æ‰€æœ‰çš„å­—èŠ‚å¹¶ä¸ç›¸ç­‰ã€‚ä¸€ä¸ª 200 KB çš„è„šæœ¬å’Œä¸€ä¸ª 200 KB çš„æ˜ åƒçš„æˆæœ¬éå¸¸ä¸åŒã€‚*



*Not all bytes weigh the same. A 200KB script has a very different set of costs to a 200KB JPG outside of the raw network transmission times for both sets of bytes.*



*å®ƒä»¬å¯èƒ½éœ€è¦åŒæ ·é•¿çš„ä¸‹è½½æ—¶é—´ï¼Œä½†æ˜¯åœ¨å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šé¢ä¸´éå¸¸ä¸åŒçš„æˆæœ¬ã€‚*

*JPEG å›¾åƒéœ€è¦è§£ç ã€æ …æ ¼åŒ–å¹¶ç»˜åˆ¶åœ¨å±å¹•ä¸Šã€‚ä¸€ä¸ª JavaScript åŒ…éœ€è¦è¢«ä¸‹è½½ï¼Œç„¶åè¢«è§£æã€ç¼–è¯‘ã€æ‰§è¡Œâ€”â€”è¿˜æœ‰è®¸å¤šå…¶ä»–æ­¥éª¤éœ€è¦å¼•æ“å®Œæˆã€‚åªæ˜¯è¦çŸ¥é“è¿™äº›æˆæœ¬å¹¶ä¸å®Œå…¨ç­‰åŒã€‚*

*å®ƒä»¬å¼€å§‹å¢åŠ å¹¶å˜å¾—é‡è¦çš„åŸå› ä¹‹ä¸€æ˜¯ç§»åŠ¨æ€§ã€‚*

# ***ç§»åŠ¨æ˜¯ä¸€ä¸ªé¢‘è°±ã€‚***



*Mobile is a spectrum composed of cheap/low-end, median and high-end devices.*



*å¦‚æœå¹¸è¿çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæœ‰ä¸€éƒ¨é«˜ç«¯æˆ–ä¸­ç«¯æ‰‹æœºã€‚ç°å®æƒ…å†µæ˜¯ï¼Œå¹¶éæ‰€æœ‰ç”¨æˆ·éƒ½å°†æ‹¥æœ‰è¿™äº›è®¾å¤‡ã€‚*

*ä»–ä»¬å¯èƒ½åœ¨ä½ç«¯æˆ–ä¸­ç«¯æ‰‹æœºä¸Šï¼Œè¿™äº›å¤šç±»è®¾å¤‡ä¹‹é—´çš„å·®å¼‚ä¹Ÿå¯èƒ½éå¸¸æ˜æ˜¾ï¼›çƒ­é‡è°ƒèŠ‚ã€ç¼“å­˜å¤§å°ã€CPUã€GPU çš„å·®å¼‚â€”â€”æ ¹æ®æ‚¨ä½¿ç”¨çš„è®¾å¤‡ï¼Œæ‚¨æœ€ç»ˆå¯èƒ½ä¼šä½“éªŒåˆ° JavaScript ç­‰èµ„æºçš„ä¸åŒå¤„ç†æ—¶é—´ã€‚ä½ çš„ä½ç«¯æ‰‹æœºç”¨æˆ·ç”šè‡³å¯èƒ½åœ¨ç¾å›½ã€‚*



*â€œInsights into the 2.3 Billion Android Smartphonesâ€ by [newzoo](https://newzoo.com/insights/articles/insights-into-the-2-3-billion-android-smartphones-in-use-around-the-world/). Android has a 75.9% share of the global market with a predicted 300m more smartphones joining the market in 2018\. Many of these will be budget Android devices.*



*ä»¥ä¸‹æ˜¯å¯¹ 2018 å¹´å¯ç”¨çš„å„ç§ç¡¬ä»¶è§£æ JavaScript æ‰€éœ€æ—¶é—´çš„ç»†åˆ†:*



*Processing (parse/compile) times for 1MB of uncompressed JavaScript (<200KB minified and gzipped) manually profiled on real devices. ([src](http://bit.ly/jscost-wpt))*



*åœ¨é¡¶ç«¯ï¼Œæˆ‘ä»¬æœ‰é«˜ç«¯è®¾å¤‡ï¼Œå¦‚ iPhone 8ï¼Œå®ƒå¤„ç†è„šæœ¬çš„é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ã€‚å†å¾€ä¸‹ï¼Œæˆ‘ä»¬æœ‰æ›´å¤šåƒ Moto G4 å’Œä½äº 100 ç¾å…ƒçš„ Alcatel 1X è¿™æ ·çš„æ™®é€šæ‰‹æœºã€‚æ³¨æ„åˆ°å¤„ç†æ—¶é—´çš„ä¸åŒäº†å—ï¼Ÿ*

*[**å®‰å“æ‰‹æœºè¶Šæ¥è¶Šä¾¿å®œï¼Œä¸æ˜¯è¶Šæ¥è¶Šå¿«ï¼Œä¹…è€Œä¹…ä¹‹**](https://twitter.com/slightlylate/status/919989184881876992) **ã€‚è¿™äº›è®¾å¤‡é€šå¸¸ CPU ä¸è¶³ï¼ŒL2/L3 ç¼“å­˜å¾ˆå°ã€‚**å¦‚æœä½ æœŸæœ›æ™®é€šç”¨æˆ·éƒ½æ‹¥æœ‰é«˜ç«¯ç¡¬ä»¶ï¼Œé‚£ä½ å°±è¾œè´Ÿäº†ä»–ä»¬ã€‚*

*è®©æˆ‘ä»¬ä½¿ç”¨æ¥è‡ªçœŸå®ç½‘ç«™çš„è„šæœ¬æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ›´å®é™…çš„ç‰ˆæœ¬ã€‚ä»¥ä¸‹æ˜¯ CNN.com çš„ JS å¤„ç†æ—¶é—´:*



*JavaScript processing times for CNN.com via WebPageTest ([src](http://bit.ly/jscost-wpt))*



*åœ¨ iPhone 8 ä¸Š(ä½¿ç”¨ [**A11**](https://en.wikipedia.org/wiki/Apple_A11) **èŠ¯ç‰‡)å¤„ç† CNN çš„ JavaScript æ¯”åœ¨æ™®é€šæ‰‹æœºä¸Šå°‘èŠ± 9 ç§’é’Ÿ**ã€‚è¿™æ¯”äº’åŠ¨ä½“éªŒå¿«äº† 9 ç§’é’Ÿã€‚*

*ç°åœ¨ WebPageTest æ”¯æŒ Alcatel 1X(åœ¨ç¾å›½é”€å”®çš„å¤§çº¦ 100 ç¾å…ƒçš„æ‰‹æœºï¼Œ[åœ¨å‘å¸ƒæ—¶å”®ç½„](https://www.androidpolice.com/2018/06/05/100-android-go-powered-alcatel-1x-goes-sale-amazon-us-next-week/))æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸­ä½ç«¯ç¡¬ä»¶ä¸ŠæŸ¥çœ‹ CNN åŠ è½½çš„ç”µå½±ã€‚æ…¢çš„ç”šè‡³ä¸ç”¨**å¼€å§‹**æ¥å½¢å®¹è¿™ä¸ª:*



*Comparison of loading CNN.com, a JavaScript-heavy site, over 3G on mid-lower end hardware ([source](https://www.webpagetest.org/video/compare.php?tests=180721_V8_c83c67c7e43ea7fa25e2be44183cc613,180721_HA_06d4462ee963136187e4faf2b079ee8f,180721_3D_8b2177b325796754562f03b755b8dca0)). The Alcatel 1X takes **65s** to fully load.*



*è¿™æš—ç¤ºæˆ‘ä»¬ä¹Ÿè®¸éœ€è¦åœæ­¢æŠŠå¿«é€Ÿç½‘ç»œå’Œå¿«é€Ÿè®¾å¤‡è§†ä¸ºç†æ‰€å½“ç„¶ã€‚*



*ä¸€äº›ç”¨æˆ·ä¸ä¼šä½¿ç”¨é«˜é€Ÿç½‘ç»œæˆ–æœ€æ–°æœ€å¥½çš„æ‰‹æœºï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹åœ¨çœŸå®çš„æ‰‹æœºå’ŒçœŸå®çš„ç½‘ç»œä¸Šè¿›è¡Œæµ‹è¯•æ˜¯è‡³å…³é‡è¦çš„ã€‚å¯å˜æ€§æ˜¯ä¸€ä¸ªçœŸæ­£çš„é—®é¢˜ã€‚*

*â€œå¯å˜æ€§æ˜¯æ‰¼æ€ç”¨æˆ·ä½“éªŒçš„ä¸œè¥¿â€â€”â€”ä¼Šåˆ©äºšÂ·æ ¼é‡Œæˆˆåˆ©å…‹ã€‚å¿«é€Ÿè®¾å¤‡å®é™…ä¸Šæœ‰æ—¶ä¼šå¾ˆæ…¢ã€‚å¿«é€Ÿç½‘ç»œå¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå¯å˜æ€§æœ€ç»ˆä¼šè®©ä¸€åˆ‡éƒ½å˜å¾—å¾ˆæ…¢ã€‚*

*å½“å˜åŒ–ä¼šæ‰¼æ€ç”¨æˆ·ä½“éªŒæ—¶ï¼Œç”¨æ…¢åŸºçº¿å¼€å‘å¯ä»¥ç¡®ä¿æ¯ä¸ªäºº(æ— è®ºæ˜¯å¿«åŸºçº¿è¿˜æ˜¯æ…¢åŸºçº¿)éƒ½å—ç›Šã€‚å¦‚æœä½ çš„å›¢é˜Ÿå¯ä»¥çœ‹ä¸€çœ‹ä»–ä»¬çš„åˆ†æï¼Œå¹¶å‡†ç¡®äº†è§£ä½ çš„ç”¨æˆ·å®é™…ä¸Šæ˜¯ç”¨ä»€ä¹ˆè®¾å¤‡è®¿é—®ä½ çš„ç½‘ç«™ï¼Œè¿™å°†ä¼šç»™ä½ ä¸€ä¸ªæç¤ºï¼Œä½ å¯èƒ½åº”è¯¥åœ¨åŠå…¬å®¤ç”¨ä»€ä¹ˆè®¾å¤‡æ¥æµ‹è¯•ä½ çš„ç½‘ç«™ã€‚*



*Test on real phones & networks.*



*[webpagetest.org/easy](https://www.webpagetest.org/easy)åœ¨â€œç§»åŠ¨â€æ¨¡å¼ä¸‹é¢„é…ç½®äº†å¤šä¸ª Moto G4ã€‚å¦‚æœæ‚¨æ— æ³•è´­ä¹°è‡ªå·±çš„ä¸€å¥—ä¸­çº§ç¡¬ä»¶è¿›è¡Œæµ‹è¯•ï¼Œè¿™æ˜¯å¾ˆæœ‰ä»·å€¼çš„ã€‚*

*é‚£é‡Œè®¾ç½®äº†è®¸å¤šé…ç½®æ–‡ä»¶ï¼Œæ‚¨ä»Šå¤©å¯ä»¥ä½¿ç”¨ï¼Œè¿™äº›æ–‡ä»¶å·²ç»é¢„å…ˆé…ç½®äº†æµè¡Œçš„è®¾å¤‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½æµ‹è¯•ä¸€äº›åƒ Moto G4 è¿™æ ·çš„ä¸­ç«¯ç§»åŠ¨è®¾å¤‡ã€‚*

*åœ¨æœ‰ä»£è¡¨æ€§çš„ç½‘ç»œä¸Šè¿›è¡Œæµ‹è¯•ä¹Ÿå¾ˆé‡è¦ã€‚è™½ç„¶æˆ‘å·²ç»è°ˆè¿‡ä½ç«¯å’Œä¸­ç«¯æ‰‹æœºæœ‰å¤šé‡è¦ï¼Œä½†æ˜¯ [Brian Holt](https://twitter.com/holtbt?lang=en) æå‡ºäº†è¿™ä¸ª[çš„è§‚ç‚¹](https://twitter.com/michaellnorth/status/935547616682827776) : **äº†è§£ä½ çš„å—ä¼—çœŸçš„å¾ˆé‡è¦ã€‚***



*â€œKnowing your audience and then appropriately focusing the performance of your application is criticalâ€ â€” Brian Holt ([src](https://www.oreilly.com/ideas/brian-holt-on-learning-javascript-and-understanding-how-to-scale-a-website))*



***ä¸æ˜¯æ¯ä¸ªç½‘ç«™éƒ½éœ€è¦åœ¨ä½ç«¯æ‰‹æœºä¸Šçš„ 2G ä¸Šè¡¨ç°è‰¯å¥½**ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ**åœ¨æ•´ä¸ªé¢†åŸŸè¿½æ±‚é«˜æ°´å¹³çš„è¡¨ç°å¹¶ä¸æ˜¯ä¸€ä»¶åäº‹ã€‚***



*Google Analytics > Audience > Mobile > Devices visualizes what devices & operating systems visit your site.*



*æ‚¨å¯èƒ½æ‹¥æœ‰èŒƒå›´å¹¿æ³›çš„é«˜ç«¯ç”¨æˆ·ï¼Œæˆ–è€…åœ¨é¢‘è°±çš„ä¸åŒéƒ¨åˆ†ã€‚åªè¦æ„è¯†åˆ°ä½ çš„ç½‘ç«™èƒŒåçš„æ•°æ®ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åˆç†åœ°åˆ¤æ–­è¿™äº›æ•°æ®æœ‰å¤šé‡è¦ã€‚*

*å¦‚æœä½ å¸Œæœ› JavaScript æ›´å¿«ï¼Œæ³¨æ„ä½ç«¯ç½‘ç»œçš„ä¸‹è½½æ—¶é—´ã€‚ä½ å¯ä»¥åšçš„æ”¹è¿›æœ‰:å‡å°‘ä»£ç ï¼Œç¼©å°ä½ çš„æºä»£ç ï¼Œåˆ©ç”¨å‹ç¼©(å³ [gzip](https://www.gnu.org/software/gzip/) ï¼Œ [Brotli](https://github.com/google/brotli) ï¼Œå’Œ [Zopfli](https://github.com/google/zopfli) )ã€‚*



*åˆ©ç”¨ç¼“å­˜è¿›è¡Œé‡å¤è®¿é—®ã€‚è§£ææ—¶é—´å¯¹äº CPU é€Ÿåº¦æ…¢çš„æ‰‹æœºæ¥è¯´è‡³å…³é‡è¦ã€‚*



*å¦‚æœæ‚¨æ˜¯åç«¯æˆ–å…¨æ ˆå¼€å‘äººå‘˜ï¼Œæ‚¨çŸ¥é“æ‚¨åœ¨ CPUã€ç£ç›˜å’Œç½‘ç»œæ–¹é¢å¾—åˆ°äº†æ‚¨æ‰€æ”¯ä»˜çš„ã€‚*

*éšç€æˆ‘ä»¬å»ºç«‹è¶Šæ¥è¶Šä¾èµ– JavaScript çš„ç½‘ç«™ï¼Œæˆ‘ä»¬æœ‰æ—¶ä¼šä»¥ä¸å®¹æ˜“çœ‹åˆ°çš„æ–¹å¼ä¸ºæˆ‘ä»¬ä¸Šä¼ çš„å†…å®¹ä»˜è´¹ã€‚*

# *å¦‚ä½•å°‘å‘ JavaScript*

*æˆåŠŸçš„å½¢å¼æ˜¯è®©æˆ‘ä»¬å‘ç”¨æˆ·å‘é€æœ€å°‘çš„è„šæœ¬ï¼ŒåŒæ—¶ä»ç„¶ç»™ä»–ä»¬ä¸€ä¸ªæœ‰ç”¨çš„ä½“éªŒã€‚ä»£ç åˆ†å‰²æ˜¯ä½¿è¿™æˆä¸ºå¯èƒ½çš„ä¸€ç§é€‰æ‹©ã€‚*



*Splitting large, monolithic JavaScript bundles can be done on a page, route or component basis. Youâ€™re even better setup for success if â€œsplittingâ€ is the default for your toolchain from the get-go.*



*ä»£ç åˆ†å‰²çš„æƒ³æ³•æ˜¯ï¼Œä¸å…¶ç»™ä½ çš„ç”¨æˆ·å‘é€ä¸€ä¸ªå·¨å¤§çš„æ•´ä½“ JavaScript åŒ…â€”â€”æœ‰ç‚¹åƒä¸€ä¸ªå·¨å¤§çš„æ¯”è¨é¥¼â€”â€”ä¸å¦‚ä½ ä¸€æ¬¡åªç»™ä»–ä»¬å‘é€ä¸€ç‰‡æ€ä¹ˆæ ·ï¼Ÿåªéœ€è¦è¶³å¤Ÿçš„è„šæœ¬ä½¿å½“å‰é¡µé¢å¯ç”¨ã€‚*

*ä»£ç æ‹†åˆ†å¯ä»¥åœ¨é¡µé¢çº§ã€è·¯ç”±çº§æˆ–ç»„ä»¶çº§å®Œæˆã€‚é€šè¿‡åƒ [webpack](https://webpack.js.org/concepts/) å’Œ [Parcel](https://parceljs.org/) è¿™æ ·çš„æ†ç»‘å™¨ï¼Œè®¸å¤šç°ä»£çš„åº“å’Œæ¡†æ¶éƒ½å¾ˆå¥½åœ°æ”¯æŒå®ƒã€‚å®Œæˆæ­¤æ“ä½œçš„å¯¼è½¨å¯ç”¨äº[ååº”](https://reactjs.org/docs/code-splitting.html)ã€ [Vue.js](https://router.vuejs.org/guide/advanced/lazy-loading.html) å’Œ[è§’åº¦](https://angular.io/guide/lazy-loading-ngmodules)ã€‚*



*Adding code-splitting in a React app using [React Loadable](https://github.com/jamiebuilds/react-loadable) â€” a higher-order component that wraps dynamic imports in a React-friendly API for adding code-splitting to your app at a given component.*



*æœ€è¿‘ï¼Œè®¸å¤šå¤§å‹å›¢é˜Ÿåœ¨æŠ•èµ„ä»£ç åˆ†å‰²æ–¹é¢å–å¾—äº†å·¨å¤§çš„æˆåŠŸã€‚*



*ä¸ºäº†åŠªåŠ›é‡å†™ä»–ä»¬çš„ç§»åŠ¨ç½‘ç»œä½“éªŒï¼Œä»¥ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿå°½å¿«ä¸ä»–ä»¬çš„ç½‘ç«™è¿›è¡Œäº¤äº’ï¼Œå½“ä»–ä»¬é‡‡ç”¨ç§¯æçš„ä»£ç åˆ†å‰²æ—¶ï¼Œ [Twitter](https://blog.twitter.com/engineering/en_us/topics/open-source/2017/how-we-built-twitter-lite.html) å’Œ [Tinder](/@addyosmani/a-tinder-progressive-web-app-performance-case-study-78919d98ece0) éƒ½å‘ç°ä»–ä»¬çš„äº¤äº’æ—¶é—´æé«˜äº† 50%ã€‚*

*åƒ[Gatsby . js](http://gatsbyjs.org)(React)[Preact CLI](https://github.com/developit/preact-cli)å’Œ [PWA Starter Kit](https://github.com/Polymer/pwa-starter-kit) è¿™æ ·çš„å †æ ˆè¯•å›¾åœ¨æ™®é€šç§»åŠ¨ç¡¬ä»¶ä¸Šå¼ºåˆ¶æ‰§è¡ŒåŠ è½½&å¿«é€Ÿäº¤äº’çš„è‰¯å¥½é»˜è®¤è®¾ç½®ã€‚*

*è®¸å¤šç½‘ç«™åšçš„å¦ä¸€ä»¶äº‹æ˜¯å°†å®¡è®¡ä½œä¸ºå·¥ä½œæµç¨‹çš„ä¸€éƒ¨åˆ†ã€‚*



*Audit your JavaScript bundles regularly. Tools like webpack-bundle-analyzer are great for analyzing your built JavaScript bundles and import-cost for Visual Code is excellent for visualizing expensive dependencies during your local iteration workflow (e.g. when you `npm install` and import a package)*



*å¹¸è¿çš„æ˜¯ï¼ŒJavaScript ç”Ÿæ€ç³»ç»Ÿæœ‰è®¸å¤šå¾ˆå¥½çš„å·¥å…·æ¥å¸®åŠ©è¿›è¡ŒåŒ…åˆ†æã€‚*

***åƒ**[**web pack Bundle Analyzer**](https://www.npmjs.com/package/webpack-bundle-analyzer)ï¼Œ[**Source Map Explorer**](https://www.npmjs.com/package/source-map-explorer)**å’Œ**[**Bundle Buddy**](https://github.com/samccone/bundle-buddy)**è¿™æ ·çš„å·¥å…·å…è®¸ä½ å®¡è®¡ä½ çš„ Bundleï¼Œå¯»æ‰¾æœºä¼šå¯¹å®ƒä»¬è¿›è¡Œå‰Šå‡ã€‚***

*è¿™äº›å·¥å…·å¯è§†åŒ–äº† JavaScript åŒ…çš„å†…å®¹:å®ƒä»¬çªå‡ºæ˜¾ç¤ºäº†å¤§å‹åº“ã€é‡å¤ä»£ç å’Œæ‚¨å¯èƒ½ä¸éœ€è¦çš„ä¾èµ–é¡¹ã€‚*



*From â€œ[Put your Webpack bundle on a diet](https://www.contentful.com/blog/2017/10/27/put-your-webpack-bundle-on-a-diet-part-3/)â€ by Benedikt RÃ¶tsch*



*æ†ç»‘åŒ…å®¡è®¡ç»å¸¸å¼ºè°ƒç”¨**è¾ƒè½»çš„**æ›¿ä»£**è¾ƒé‡çš„**ä¾èµ–é¡¹(å¦‚ Moment.js åŠå…¶è¯­è¨€ç¯å¢ƒ)(å¦‚ [date-fns](https://github.com/date-fns/date-fns) )çš„æœºä¼šã€‚*

*å¦‚æœä½ ä½¿ç”¨ webpackï¼Œä½ ä¼šå‘ç°æˆ‘ä»¬çš„[å¸¸è§åº“é—®é¢˜åº“](https://github.com/GoogleChromeLabs/webpack-libs-optimizations)å¾ˆæœ‰ç”¨ã€‚*

# *æµ‹é‡ã€ä¼˜åŒ–ã€ç›‘æ§å’Œé‡å¤ã€‚*

*å¦‚æœæ‚¨ä¸ç¡®å®š JavaScript çš„æ€»ä½“æ€§èƒ½æ˜¯å¦æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [Lighthouse](https://developers.google.com/web/tools/lighthouse/) :*



*Lighthouse recently added a number of useful new [performance audits](https://developers.google.com/web/updates/2018/05/lighthouse) that you may not be aware of.*



*Lighthouse æ˜¯ä¸€ä¸ªåµŒå…¥åˆ° Chrome å¼€å‘è€…å·¥å…·ä¸­çš„å·¥å…·ã€‚å®ƒä¹Ÿå¯ä»¥ä½œä¸º [Chrome æ‰©å±•](https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk?hl=en)ä½¿ç”¨ã€‚å®ƒä¸ºæ‚¨æä¾›äº†æ·±å…¥çš„æ€§èƒ½åˆ†æï¼Œçªå‡ºäº†æé«˜æ€§èƒ½çš„æœºä¼šã€‚*



*æˆ‘ä»¬æœ€è¿‘å¢åŠ äº†å¯¹ Lighthouse æ ‡è®°é«˜" [JavaScript å¯åŠ¨æ—¶é—´](https://developers.google.com/web/updates/2018/05/lighthouse#javascript_boot-up_time_is_high)"çš„æ”¯æŒã€‚è¯¥å®¡è®¡çªå‡ºæ˜¾ç¤ºäº†å¯èƒ½èŠ±è´¹å¾ˆé•¿æ—¶é—´è§£æ/ç¼–è¯‘ä»è€Œå»¶è¿Ÿäº¤äº’çš„è„šæœ¬ã€‚æ‚¨å¯ä»¥å°†è¿™æ¬¡å®¡è®¡è§†ä¸ºæ‹†åˆ†è¿™äº›è„šæœ¬æˆ–è€…å‡å°‘å·¥ä½œé‡çš„æœºä¼šã€‚*

*æ‚¨å¯ä»¥åšçš„å¦ä¸€ä»¶äº‹æ˜¯ç¡®ä¿æ‚¨æ²¡æœ‰å°†æœªä½¿ç”¨çš„ä»£ç äº¤ä»˜ç»™æ‚¨çš„ç”¨æˆ·:*



*Find unused CSS and JS code with the [Coverage tab in Chrome DevTools](https://developers.google.com/web/updates/2017/04/devtools-release-notes#coverage).*



*ä»£ç è¦†ç›–ç‡æ˜¯ DevTools ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå…è®¸ä½ å‘ç°é¡µé¢ä¸­æœªä½¿ç”¨çš„ JavaScript(å’Œ CSS)ã€‚åœ¨ DevTools ä¸­åŠ è½½ä¸€ä¸ªé¡µé¢ï¼Œè¦†ç›–ç‡é€‰é¡¹å¡å°†æ˜¾ç¤ºæ‰§è¡Œäº†å¤šå°‘ä»£ç å’ŒåŠ è½½äº†å¤šå°‘ä»£ç ã€‚æ‚¨å¯ä»¥é€šè¿‡åªå‘å¸ƒç”¨æˆ·éœ€è¦çš„ä»£ç æ¥æé«˜é¡µé¢çš„æ€§èƒ½ã€‚*



***æç¤º:é€šè¿‡è¦†ç›–ç‡è®°å½•ï¼Œæ‚¨å¯ä»¥ä¸æ‚¨çš„åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’ï¼ŒDevTools å°†æ›´æ–°æ‚¨çš„æ†ç»‘åŒ…çš„ä½¿ç”¨é‡ã€‚***

*è¿™å¯¹äºè¯†åˆ«æ‹†åˆ†è„šæœ¬çš„æœºä¼šä»¥åŠå°†éå…³é”®è„šæœ¬çš„åŠ è½½æ¨è¿Ÿåˆ°éœ€è¦æ—¶è¿›è¡Œå¾ˆæœ‰ä»·å€¼ã€‚*

*å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ä¸€ç§é«˜æ•ˆåœ°ä¸ºç”¨æˆ·æä¾› JavaScript æœåŠ¡çš„æ¨¡å¼ï¼Œçœ‹çœ‹ [PRPL æ¨¡å¼](https://developers.google.com/web/fundamentals/performance/prpl-pattern/)ã€‚*



*PRPL is a performance pattern for efficient loading. It stands for (P)ush critical resources for the initial route, (R)ender initial route, (P)re-cache remaining routes, (L)azy-load and create remaining routes on demand*



***PRPL (Pushã€Renderã€Precache å’Œ Lazy-Load)æ˜¯ä¸€ç§æ¨¡å¼ï¼Œå®ƒç§¯æåœ°ä¸ºæ¯ä¸€æ¡è·¯çº¿åˆ†å‰²ä»£ç ï¼Œç„¶ååˆ©ç”¨ä¸€ä¸ª** [**æœåŠ¡å·¥ä½œè€…**](https://developers.google.com/web/fundamentals/primers/service-workers/) **é¢„å…ˆç¼“å­˜æœªæ¥è·¯çº¿æ‰€éœ€çš„ JavaScript å’Œé€»è¾‘ï¼Œå¹¶åœ¨éœ€è¦æ—¶è¿›è¡Œ Lazy åŠ è½½ã€‚***

*è¿™æ„å‘³ç€ï¼Œå½“ç”¨æˆ·å¯¼èˆªåˆ°ä½“éªŒä¸­çš„å…¶ä»–è§†å›¾æ—¶ï¼Œå®ƒå¾ˆå¯èƒ½å·²ç»åœ¨æµè§ˆå™¨ç¼“å­˜ä¸­ï¼Œå› æ­¤ä»–ä»¬åœ¨å¯åŠ¨è„šæœ¬å’Œè¿›è¡Œäº¤äº’æ–¹é¢çš„æˆæœ¬ä¼šé™ä½å¾ˆå¤šã€‚*

*å¦‚æœæ‚¨å…³å¿ƒæ€§èƒ½ï¼Œæˆ–è€…æ‚¨æ›¾ç»ä¸ºæ‚¨çš„ç«™ç‚¹å¼€å‘è¿‡æ€§èƒ½è¡¥ä¸ï¼Œé‚£ä¹ˆæ‚¨ä¼šçŸ¥é“ï¼Œæœ‰æ—¶æ‚¨å¯èƒ½ä¼šæœ€ç»ˆè‡´åŠ›äºä¸€ä¸ªä¿®å¤ï¼Œä½†å‡ å‘¨åå›æ¥æ—¶å´å‘ç°æ‚¨å›¢é˜Ÿä¸­çš„æŸä¸ªäººæ­£åœ¨å¼€å‘ä¸€ä¸ªç‰¹æ€§ï¼Œæ— æ„ä¸­ç ´åäº†ä½“éªŒã€‚äº‹æƒ…å¤§æ¦‚æ˜¯è¿™æ ·çš„:*



*ä»¤äººæ¬£æ…°çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ï¼Œå…¶ä¸­ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ¶å®š[](https://timkadlec.com/2013/01/setting-a-performance-budget/)**ç»©æ•ˆé¢„ç®—ã€‚***



***ç»©æ•ˆé¢„ç®—è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒè®©æ¯ä¸ªäººéƒ½ä¿æŒä¸€è‡´ã€‚ä»–ä»¬ä¸ºä¸æ–­æ”¹å–„ç”¨æˆ·ä½“éªŒå’Œå›¢é˜Ÿè´£ä»»åˆ›é€ äº†ä¸€ç§å…±äº«çƒ­æƒ…çš„æ–‡åŒ–ã€‚***

***é¢„ç®—å®šä¹‰äº†å¯è¡¡é‡çš„**çº¦æŸ**ä»¥å…è®¸å›¢é˜Ÿè¾¾åˆ°ä»–ä»¬çš„ç»©æ•ˆç›®æ ‡ã€‚å› ä¸ºæ‚¨å¿…é¡»åœ¨é¢„ç®—çš„é™åˆ¶å†…ç”Ÿæ´»ï¼Œæ‰€ä»¥æ€§èƒ½æ˜¯æ¯ä¸€æ­¥éƒ½è¦è€ƒè™‘çš„å› ç´ ï¼Œè€Œä¸æ˜¯äº‹åæ‰è€ƒè™‘çš„å› ç´ ã€‚***

***æ ¹æ® Tim Kadlec çš„å·¥ä½œï¼Œæ€§èƒ½é¢„ç®—çš„æŒ‡æ ‡å¯ä»¥åŒ…æ‹¬:***

*   *****é‡Œç¨‹ç¢‘è®¡æ—¶** â€”åŸºäºåŠ è½½é¡µé¢çš„*ç”¨æˆ·ä½“éªŒ*çš„è®¡æ—¶(ä¾‹å¦‚ï¼Œäº¤äº’æ—¶é—´)ã€‚åœ¨é¡µé¢åŠ è½½è¿‡ç¨‹ä¸­ï¼Œæ‚¨ç»å¸¸å¸Œæœ›å°†å‡ ä¸ªé‡Œç¨‹ç¢‘è®¡æ—¶é…å¯¹ï¼Œä»¥å‡†ç¡®åœ°è¡¨ç¤ºå®Œæ•´çš„æ•…äº‹ã€‚***
*   *****åŸºäºè´¨é‡çš„æŒ‡æ ‡** â€”åŸºäºåŸå§‹å€¼(ä¾‹å¦‚ JavaScript çš„æƒé‡ã€HTTP è¯·æ±‚çš„æ•°é‡)ã€‚è¿™äº›éƒ½é›†ä¸­åœ¨*æµè§ˆå™¨*ä½“éªŒä¸Šã€‚***
*   *****åŸºäºè§„åˆ™çš„æŒ‡æ ‡** â€”ç”± Lighthouse æˆ– WebPageTest ç­‰å·¥å…·ç”Ÿæˆçš„åˆ†æ•°ã€‚é€šå¸¸ï¼Œä¸€ä¸ªå•ä¸€çš„æ•°å­—æˆ–ç³»åˆ—æ¥è¯„åˆ†ä½ çš„ç½‘ç«™ã€‚***



***äºšå†å…‹æ–¯Â·ç½—ç´ æœ‰ä¸€ä¸ªå…³äºç»©æ•ˆé¢„ç®—çš„æ¨ç‰¹é£æš´ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªè¦ç‚¹å€¼å¾—æ³¨æ„:***

*   ***[**â€œé¢†å¯¼è®¤åŒé‡è¦**](https://twitter.com/slightlylate/status/1018508800590876672?s=19) **ã€‚æ„¿æ„æš‚åœåŠŸèƒ½å·¥ä½œä»¥ä¿æŒè‰¯å¥½çš„æ•´ä½“ç”¨æˆ·ä½“éªŒå®šä¹‰äº†æŠ€æœ¯äº§å“çš„æ·±æ€ç†Ÿè™‘çš„ç®¡ç†ã€‚â€*****
*   ***â€œç»©æ•ˆæ˜¯ç”±å·¥å…·æ”¯æŒçš„æ–‡åŒ–ã€‚æµè§ˆå™¨å°½å¯èƒ½ä¼˜åŒ– HTML+CSSã€‚å°†æ›´å¤šçš„å·¥ä½œè½¬ç§»åˆ° JS ä¼šç»™ä½ çš„å›¢é˜Ÿå’Œä»–ä»¬çš„å·¥å…·å¸¦æ¥è´Ÿæ‹…â€***
*   ***â€œé¢„ç®—ä¸ä¼šè®©ä½ éš¾è¿‡ã€‚ä»–ä»¬åœ¨é‚£é‡Œä½¿ç»„ç»‡è‡ªæˆ‘çº æ­£ã€‚å›¢é˜Ÿéœ€è¦é¢„ç®—æ¥é™åˆ¶å†³ç­–ç©ºé—´ï¼Œå¹¶å¸®åŠ©å®ç°å®ƒä»¬â€***

***æ¯ä¸ªå½±å“ç½‘ç«™ç”¨æˆ·ä½“éªŒçš„äººéƒ½ä¸ç½‘ç«™çš„è¡¨ç°æœ‰å…³ã€‚***



***Make performance part of the conversation.***



***è¡¨æ¼”æ›´å¤šæ—¶å€™æ˜¯ä¸€ç§æ–‡åŒ–æŒ‘æˆ˜ï¼Œè€Œä¸æ˜¯æŠ€æœ¯æŒ‘æˆ˜ã€‚***

***åœ¨è®¡åˆ’ä¼šè®®å’Œå…¶ä»–èšä¼šä¸­è®¨è®ºç»©æ•ˆã€‚è¯¢é—®ä¸šåŠ¡å¹²ç³»äººä»–ä»¬çš„ç»©æ•ˆæœŸæœ›æ˜¯ä»€ä¹ˆã€‚ä»–ä»¬äº†è§£ç»©æ•ˆå¦‚ä½•å½±å“ä»–ä»¬å…³å¿ƒçš„ä¸šåŠ¡æŒ‡æ ‡å—ï¼Ÿé—® engã€‚å›¢é˜Ÿè®¡åˆ’å¦‚ä½•è§£å†³æ€§èƒ½ç“¶é¢ˆã€‚è™½ç„¶è¿™é‡Œçš„ç­”æ¡ˆå¯èƒ½å¹¶ä¸ä»¤äººæ»¡æ„ï¼Œä½†å®ƒä»¬è®©å¯¹è¯å¼€å§‹äº†ã€‚***



***â€œMake performance relevant to your stakeholdersâ€™ goals by showing how it can impact the key metrics they care about. Without a performance culture, performance is not sustainableâ€ â€” [Allison McKnight](https://vimeo.com/254947097)***



***è¿™é‡Œæœ‰ä¸€ä¸ªç»©æ•ˆè¡ŒåŠ¨è®¡åˆ’:
- **åˆ›é€ ä½ çš„ç»©æ•ˆæ„¿æ™¯**ã€‚è¿™æ˜¯ä¸€ä»½ä¸€é¡µçš„åè®®ï¼Œå†…å®¹æ˜¯å…³äºä¸šåŠ¡åˆ©ç›Šç›¸å…³è€…å’Œå¼€å‘äººå‘˜è®¤ä¸ºä»€ä¹ˆæ˜¯â€œè‰¯å¥½çš„ç»©æ•ˆâ€
- **è®¾å®šæ‚¨çš„ç»©æ•ˆé¢„ç®—**ã€‚ä»æ„¿æ™¯ä¸­æå–å…³é”®ç»©æ•ˆæŒ‡æ ‡(KPI ),å¹¶ä»ä¸­è®¾å®šç°å®çš„ã€å¯è¡¡é‡çš„ç›®æ ‡ã€‚ä¾‹å¦‚â€œ5s å†…åŠ è½½å¹¶è·å¾—äº¤äº’â€ã€‚è§„æ¨¡é¢„ç®—å¯èƒ½ä¼šå› æ­¤ä¸‹é™ã€‚ä¾‹å¦‚â€œä¿æŒ JS < 170KB ç¼©å°/å‹ç¼©â€
- **åˆ›å»ºå…³äº KPI çš„å®šæœŸæŠ¥å‘Šã€‚**è¿™å¯ä»¥æ˜¯å‘é€ç»™ä¸šåŠ¡éƒ¨é—¨çš„å®šæœŸæŠ¥å‘Šï¼Œå¼ºè°ƒè¿›åº¦å’ŒæˆåŠŸã€‚***

***å®‰è¿ªÂ·æ–¯è’‚å°”çš„ã€Šç½‘ç»œæ€§èƒ½æˆ˜å£«ã€‹å’ŒåŠ³æ‹‰Â·éœæ ¹çš„ã€Šä¸ºæ€§èƒ½è€Œè®¾è®¡çš„ T2ã€‹éƒ½æ˜¯å¾ˆå¥½çš„ä¹¦ç±ï¼Œè®¨è®ºäº†å¦‚ä½•è€ƒè™‘å»ºç«‹ä¸€ç§æ€§èƒ½æ–‡åŒ–ã€‚***

*****ç»©æ•ˆé¢„ç®—å·¥å…·æ€ä¹ˆæ ·ï¼Ÿ**æ‚¨å¯ä»¥åœ¨ä¸[ç¯å¡” CI](https://github.com/ebidel/lighthouse-ci) é¡¹ç›®çš„æŒç»­é›†æˆä¸­è®¾ç½®ç¯å¡”è¯„åˆ†é¢„ç®—:***



***Prevent pull requests from being merged if your perf scores fall below a certain value with [Lighthouse CI](https://github.com/ebidel/lighthouse-ci). [Lighthouse Thresholds](https://github.com/luke-j/lighthouse-thresholds) is another configuration-based approach to setting perf budgets.***



***è®¸å¤šæ€§èƒ½ç›‘æ§æœåŠ¡æ”¯æŒè®¾ç½®æ€§èƒ½é¢„ç®—å’Œé¢„ç®—è­¦æŠ¥ï¼ŒåŒ…æ‹¬[å£å¾„](https://calibreapp.com/)ã€ [Treo](https://treo.sh/a/addyosmani/3) ã€ [Webdash](https://webdash.xyz/) å’Œ[é€Ÿåº¦æ›²çº¿](https://speedcurve.com/about/):***



***JavaScript perf budgets for my site [teejungle.net](https://teejungle.net/) using SpeedCurve which supports a range of [budget metrics](http://support.speedcurve.com/get-the-most-out-of-speedcurve/create-performance-budgets-and-set-alerts).***



***æ¥å—æ€§èƒ½é¢„ç®—é¼“åŠ±å›¢é˜Ÿä»è®¾è®¡é˜¶æ®µçš„æ—©æœŸä¸€ç›´åˆ°é‡Œç¨‹ç¢‘çš„ç»“æŸï¼Œè®¤çœŸè€ƒè™‘ä»–ä»¬æ‰€åšçš„ä»»ä½•å†³ç­–çš„åæœã€‚***

***å¯»æ‰¾è¿›ä¸€æ­¥çš„å‚è€ƒï¼Ÿ[ç¾å›½æ•°å­—æœåŠ¡](https://designsystem.digital.gov/performance/how/)è®°å½•äº†ä»–ä»¬é€šè¿‡ä¸ºäº’åŠ¨æ—¶é—´ç­‰æŒ‡æ ‡è®¾å®šç›®æ ‡å’Œé¢„ç®—æ¥è·Ÿè¸ª Lighthouse ç»©æ•ˆçš„æ–¹æ³•ã€‚***

***æ¥ä¸‹æ¥..***

*****æ¯ä¸ªç°åœºåº”èƒ½è®¿é—®** [**å®éªŒå®¤å’Œç°åœºæ€§èƒ½æ•°æ®**](https://developers.google.com/web/fundamentals/performance/speed-tools/) **ã€‚*****

***ä¸ºäº†è·Ÿè¸ª JavaScript åœ¨ RUM(çœŸå®ç”¨æˆ·ç›‘æ§)ç¯å¢ƒä¸‹å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ï¼Œæˆ‘æ¨èæŸ¥çœ‹ä¸¤ä¸ªå³å°†å‡ºç°åœ¨ web ä¸Šçš„ä¸œè¥¿ã€‚***



***Field data (or RUM â€” Real User Monitoring) is performance data collected from real page loads your users are experiencing in the wild. Sites with heavy JavaScript payloads would benefit from measuring main-thread of this work through Long Tasks and First Input Delay.***



***ç¬¬ä¸€ä¸ªæ˜¯[é•¿ä»»åŠ¡](https://w3c.github.io/longtasks/)â€”â€”ä¸€ä¸ª APIï¼Œä½¿æ‚¨èƒ½å¤Ÿæ”¶é›†æŒç»­æ—¶é—´è¶…è¿‡ 50 æ¯«ç§’çš„ä»»åŠ¡(åŠå…¶å±æ€§è„šæœ¬)çš„çœŸå®é¥æµ‹æ•°æ®ï¼Œè¿™äº›ä»»åŠ¡å¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚æ‚¨å¯ä»¥è®°å½•è¿™äº›ä»»åŠ¡ï¼Œå¹¶å°†å…¶è®°å½•åˆ°æ‚¨çš„åˆ†æä¸­ã€‚***

***[é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ](https://developers.google.com/web/updates/2018/05/first-input-delay) (FID)æ˜¯ä¸€ä¸ªè¡¡é‡ä»ç”¨æˆ·ç¬¬ä¸€æ¬¡ä¸æ‚¨çš„ç½‘ç«™äº¤äº’(å³å½“ä»–ä»¬ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®æ—¶)åˆ°æµè§ˆå™¨å®é™…èƒ½å¤Ÿå“åº”è¯¥äº¤äº’çš„æ—¶é—´çš„æŒ‡æ ‡ã€‚FID ä»ç„¶æ˜¯ä¸€ä¸ªæ—©æœŸçš„æŒ‡æ ‡ï¼Œä½†æˆ‘ä»¬ä»Šå¤©æœ‰ä¸€ä¸ª [polyfill](https://github.com/GoogleChromeLabs/first-input-delay) å¯ä¾›æ‚¨æŸ¥çœ‹ã€‚***



***åœ¨è¿™ä¸¤è€…ä¹‹é—´ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿä»çœŸå®ç”¨æˆ·é‚£é‡Œè·å¾—è¶³å¤Ÿçš„é¥æµ‹æ•°æ®ï¼Œä»¥äº†è§£ä»–ä»¬é‡åˆ°äº†å“ªäº› JavaScript æ€§èƒ½é—®é¢˜ã€‚***



***Marcel Freinbichler had a [viral tweet](https://twitter.com/fr3ino/status/1000166112615714816) about USA Today shipping a slim version of their site to EU users. It loaded 42 seconds faster than their normal pages.***



***ä¼—æ‰€å‘¨çŸ¥ï¼Œç¬¬ä¸‰æ–¹ JavaScript ä¼šå¯¹é¡µé¢åŠ è½½æ€§èƒ½äº§ç”Ÿå¯æ€•çš„å½±å“ã€‚è™½ç„¶è¿™ä»ç„¶æ˜¯äº‹å®ï¼Œä½†é‡è¦çš„æ˜¯è¦æ‰¿è®¤ï¼Œä»Šå¤©çš„è®¸å¤šä½“éªŒä¹Ÿè‡ªå¸¦äº†è®¸å¤šç¬¬ä¸€æ–¹ JavaScriptã€‚å¦‚æœæˆ‘ä»¬è¦å¿«é€ŸåŠ è½½ï¼Œæˆ‘ä»¬éœ€è¦æ¶ˆé™¤è¿™ä¸ªé—®é¢˜çš„ä¸¤ä¸ªæ–¹é¢å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ã€‚***

***æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°äº†å‡ ä¸ªå¸¸è§çš„å¤±è¯¯ï¼ŒåŒ…æ‹¬å›¢é˜Ÿåœ¨æ–‡æ¡£å¤´ä¸­ä½¿ç”¨é˜»å¡ JavaScript æ¥å†³å®šå‘ç”¨æˆ·æ˜¾ç¤ºä»€ä¹ˆæ ·çš„ A/B æµ‹è¯•ã€‚æˆ–è€…ï¼Œä¸º A/B æµ‹è¯•çš„æ‰€æœ‰å˜ä½“äº¤ä»˜ JSï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå°†è¢«å®é™…ä½¿ç”¨ğŸ¤¯***



***å¦‚æœè¿™æ˜¯ä½ ç›®å‰é‡åˆ°çš„ä¸»è¦ç“¶é¢ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå•ç‹¬çš„å…³äºåŠ è½½ç¬¬ä¸‰æ–¹ JavaScript çš„æŒ‡å—[](https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/loading-third-party-javascript/)****ã€‚*******

# *****å˜å¿«ï¼Œä¿æŒé€Ÿåº¦ã€‚*****

*****è¡¨æ¼”æ˜¯ä¸€ä¸ªæ—…ç¨‹ã€‚è®¸å¤šå°çš„æ”¹å˜å¯ä»¥å¸¦æ¥å¤§çš„æ”¶è·ã€‚*****

*****è®©ç”¨æˆ·ä»¥æœ€å°‘çš„æ‘©æ“¦ä¸ä½ çš„ç½‘ç«™äº’åŠ¨ã€‚è¿è¡Œæœ€å°‘çš„ JavaScript æ¥äº¤ä»˜çœŸæ­£çš„ä»·å€¼ã€‚è¿™å¯èƒ½æ„å‘³ç€é‡‡å–æ¸è¿›çš„æ­¥éª¤æ¥å®ç°ã€‚*****

*****æœ€ç»ˆï¼Œä½ çš„ç”¨æˆ·ä¼šæ„Ÿè°¢ä½ ã€‚*****



*******å‚è€ƒæ–‡çŒ®*******

******éå¸¸æ„Ÿè°¢* [*æ‰˜é©¬æ–¯Â·æ–¯å¦çº³*](https://twitter.com/tomayac)*[*äºšå†å…‹æ–¯Â·ç½—ç´ *](https://twitter.com/slightlylate)*[*æ°ç‘ç±³Â·ç“¦æ ¼çº³*](https://twitter.com/malchata)*[*å¸•ç‰¹é‡Œå…‹Â·èµ«å°”èŒ¨*](https://twitter.com/patrickhulce) *ï¼Œæ±¤å§†Â·å®‰å…‹æ–¯* [*ä¾¯å¡å› Â·å‰å¾·*](https://twitter.com/hdjirdeh) *çš„è´¡çŒ®ä¹Ÿæ„Ÿè°¢ Pat Meenan å¯¹ WebPageTest çš„æŒç»­å·¥ä½œâ€”å¦‚æœæ„Ÿå…´è¶£ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå…³äº* [*æœ¬é¡µ*](https://www.webpagetest.org/lighthouse.php?test=180801_55_0cb6a6efefd4067b9b3ac7655ab13a26&run=1) *çš„ç¯å¡”æŠ¥å‘Šã€‚ä½ å¯ä»¥åœ¨* [*æ¨ç‰¹*](https://twitter.com/addyosmani) *ä¸Šå…³æ³¨æˆ‘çš„ä½œå“ã€‚*********





































